<!doctype html><html lang="pt-br"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Professor — Dashboard</title><link rel="stylesheet" href="/test/gestor/assets/styles.css"></head><body><button id="theme-toggle" class="theme-toggle btn secondary">Tema</button><div class="wrap"><div class="card"><h2 class="title">Bem-vindo, Professor</h2><div id="info" class="muted"></div><div class="nav"><button class="btn" id="minhas">Minhas aulas da semana</button></div></div><div class="card"><div id="schedule"></div><pre id="res" class="muted" style="display:none"></pre></div></div><div id="toast" class="toast" style="display:none"></div><script type="module">import{request,applyTheme,toggleTheme,ensureTokenOrRedirect}from'/test/gestor/assets/api.js';applyTheme();document.getElementById('theme-toggle').onclick=toggleTheme;ensureTokenOrRedirect();(async()=>{const me=await request('GET','/api/auth/me');document.getElementById('info').textContent=(me?.data?.nome||'')+' ('+(me?.data?.email||'')+')'})();function fmtDate(d){try{return new Date(d)}catch{return null}}function groupByDay(list){const days={};(list||[]).forEach(a=>{const dt=fmtDate(a.dataHora);if(!dt)return;const key=dt.toLocaleDateString('pt-BR',{weekday:'long',year:'numeric',month:'2-digit',day:'2-digit'});if(!days[key])days[key]=[];days[key].push(a)});return days}function renderSchedule(list){const cont=document.getElementById('schedule');cont.innerHTML='';const days=groupByDay(list);const keys=Object.keys(days);if(keys.length===0){cont.innerHTML='<div class="muted">Não há aulas agendadas nesta semana.</div>';return}keys.sort((a,b)=>{const pa=a.split(', ').pop();const pb=b.split(', ').pop();return new Date(pa)-new Date(pb)});keys.forEach(k=>{const sec=document.createElement('div');sec.className='section';const h=document.createElement('h3');h.className='title';h.textContent=k;sec.appendChild(h);const ul=document.createElement('div');ul.className='list';days[k].sort((x,y)=>fmtDate(x.dataHora)-fmtDate(y.dataHora)).forEach(a=>{const li=document.createElement('div');li.className='row';const dt=fmtDate(a.dataHora);const hora=dt?dt.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'}):'';const nome=a.nome||('Aula');const status=(a.status||'agendada');li.innerHTML=`<div><strong>${hora}</strong> • ${nome}</div><div class="muted">${status}</div>`;ul.appendChild(li)});sec.appendChild(ul);cont.appendChild(sec)})}document.getElementById('minhas').onclick=async()=>{const r=await request('GET','/api/aulas/minhas/semana');document.getElementById('res').textContent=JSON.stringify(r.data);renderSchedule(r.data||[])};</script></body></html>